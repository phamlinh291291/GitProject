<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <fieldset>
        <legend>Thêm học viên</legend>
        <table>
            <tr>
                <td>Họ tên</td>
                <td>
                    <input id="hoTen" oninput="timKiemHocVien()" class="inputinfo" />
                </td>
            </tr>
            <tr>
                <td>Số điện thoại</td>
                <td>
                    <input id="soDienThoai" class="inputinfo" />
                </td>
            </tr>
            <tr>
                <td>Giới tính</td>
                <td>
                    <input type="radio" name="gioiTinh" value="1" checked id="gtNu">Nữ
                    <input type="radio" name="gioiTinh" value="0" id="gtNam">Nam
                </td>
            </tr>
            <tr>
                <td>Điểm</td>
                <td>
                    <input type="number" min="0" max="10" id="diem" class="inputinfo" />
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <button type="button" onclick="themMoiHocVien()">Thêm mới</button>
                    <button type="button" onclick="kiemTraTonTai()">check</button>
                    <button type="button" onclick="timKiemHocVien()">find student</button>
                </td>
            </tr>
        </table>
    </fieldset>
    <fieldset>
        <legend>Danh sách học viên</legend>
        <button type="button" onclick="hienThiDanhSachHocVien()">Lấy danh sách</button>
        <table border="1" cellpadding="5" cellspacing="0">
            <thead>
                <tr>
                    <th>STT</th>
                    <th>Họ tên</th>
                    <th>Số điện thoại</th>
                    <th>Giới tính</th>
                    <th>Điểm</th>
                </tr>
            </thead>
            <tbody id="ketQua"></tbody>
        </table>
    </fieldset>
    <script>
        const DS_HOC_VIEN_KEY = "dsHocVien"; 4
        class HocVien {
            constructor(hoTen, soDienThoai, gioiTinh, diem) {
                this.hoTen = hoTen;
                this.soDienThoai = soDienThoai;
                this.gioiTinh = gioiTinh;
                this.diem = diem;


            }

        }
        function docThongTinHocVienTuLocalStorage() {
            try {
                let dsHocVien = localStorage.getItem(DS_HOC_VIEN_KEY);
                if (dsHocVien === null) {
                    return [];
                } else {
                    return JSON.parse(dsHocVien);
                }
            } catch (e) {
                console.log(e)
                return [];
            }
        }

        function kiemTraTonTai() {
            let dsHocVien = docThongTinHocVienTuLocalStorage();
            let ho_Ten = document.getElementById("hoTen").value;
            let so_Dien_Thoai = document.getElementById("soDienThoai").value;
            let check;
            for (let i = 0; i < dsHocVien.length; i++) {
                if (dsHocVien[i].hoTen === ho_Ten && dsHocVien[i].soDienThoai === so_Dien_Thoai) {
                    //console.log(i, dsHocVien[i].hoTen);
                    check = true;
                } else check = false;


            }

            return check;
        }
        function timKiemHocVien() {
            let dsHocVien = docThongTinHocVienTuLocalStorage();
            let str = document.getElementById("hoTen").value;
            console.log(str);
            let j = 0;
            for (let i = 0; i < dsHocVien.length; i++) {
                //let str1 = dsHocVien[i].hoTen[0];
                //console.log(str1);
                // for (let j = 0; i < dsHocVien[i].hoTen.length; j++) {
                let str1 = dsHocVien[i].hoTen[0];
                console.log(str1);
                if (str === str1) {
                    console.log(str, i, "--", str1);

                }
                //}
            }



        }
        function themMoiHocVien() {
            console.log(kiemTraTonTai());
            if (kiemTraTonTai()) {
                alert(`đã tồn tại học viên ${document.getElementById("hoTen").value} với số điện thoại ${document.getElementById("soDienThoai").value}`);
                document.getElementsByClassName("inputinfo").value = "";
            }
            else {
                let hocVien = new HocVien(
                    document.getElementById("hoTen").value,
                    document.getElementById("soDienThoai").value,
                    document.getElementById("gtNam").checked,
                    parseFloat(document.getElementById("diem").value)
                );

                // tạo đối tượng học viên

                //console.log(hocVien);

                //lấy danh sách học viên từ localStorage
                let dsHocVien = docThongTinHocVienTuLocalStorage();
                // tìm dựa vào số điện thoại xem học viên đã có trong danh sách hay chưa
                // thêm vào mảng các học viên
                dsHocVien.push(hocVien);


                // ghi mảng học viên vào localStorage
                localStorage.setItem(DS_HOC_VIEN_KEY, JSON.stringify(dsHocVien));
                document.getElementsByClassName("inputinfo").value = "";
            }
        }



        function hienThiDanhSachHocVien() {
            //lấy danh sách học viên từ localStorage
            document.getElementById("ketQua").innerHTML = "";
            let dsHocVien = docThongTinHocVienTuLocalStorage();
            //console.log(dsHocVien);
            //let chuoi =document.getElementById("ketQua").innerHTML;
            let stt = 0;
            for (let i = 0; i < dsHocVien.length; i++) {
                stt++;
                let dong = document.createElement("tr");
                let o_1 = document.createElement("td");
                o_1.innerHTML += stt;
                let o_2 = document.createElement("td");
                o_2.innerHTML = dsHocVien[i].hoTen;
                console.log(o_2.innerHTML);
                let o_3 = document.createElement("td");
                o_3.innerHTML = dsHocVien[i].soDienThoai;
                let o_4 = document.createElement("td");
                o_4.innerHTML = dsHocVien[i].gioiTinh;
                let o_5 = document.createElement("td");
                o_5.innerHTML = dsHocVien[i].diem;
                dong.appendChild(o_1);
                dong.appendChild(o_2);
                dong.appendChild(o_3);
                dong.appendChild(o_4);
                dong.appendChild(o_5);
                document.getElementById("ketQua").appendChild(dong);
            }
        }
    </script>
</body>

</html>